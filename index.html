<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Feli Cunpleaños Diana</title>
  <style>
    :root {
      --bg1:#050814;
      --bg2:#0b1030;
      --txt:#ffffff;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      overflow:hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 50% 30%, #101a55 0%, var(--bg2) 35%, var(--bg1) 75%, #02040e 100%);
      color:var(--txt);
    }

    canvas{
      position:fixed; inset:0;
      width:100vw; height:100vh;
      display:block;
    }

    .overlay{
      position:fixed; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      pointer-events:none;
      padding:24px;
      text-align:center;
    }

    .card{
      pointer-events:none;
      padding:18px 20px;
      border-radius:18px;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(8px);
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
      max-width: min(720px, 92vw);
    }

    h1{
      margin:0;
      font-size: clamp(28px, 5vw, 64px);
      letter-spacing: .5px;
      line-height:1.05;
      text-shadow: 0 6px 28px rgba(0,0,0,.6);
      font-weight: 800;
    }

    .hint{
      margin-top:10px;
      font-size: clamp(12px, 2vw, 16px);
      opacity:.85;
    }

    .pillbar{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      display:flex;
      gap:10px;
      align-items:center;
      pointer-events:auto;
      padding:10px 12px;
      border-radius:999px;
      background: rgba(0,0,0,.30);
      border: 1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(10px);
    }

    button{
      appearance:none;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: #fff;
      padding: 10px 12px;
      border-radius: 999px;
      cursor:pointer;
      font-weight: 600;
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
      user-select:none;
    }
    button:hover{ background: rgba(255,255,255,.12); border-color: rgba(255,255,255,.22); }
    button:active{ transform: scale(.98); }

    .toggle{
      display:flex;
      align-items:center;
      gap:8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      font-size: 14px;
      user-select:none;
      cursor:pointer;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background:#66ff9c;
      box-shadow: 0 0 18px rgba(102,255,156,.7);
    }
    .dot.off{
      background:#ff6b6b;
      box-shadow: 0 0 18px rgba(255,107,107,.7);
    }

    @media (prefers-reduced-motion: reduce){
      .hint::after{ content:" (movimiento reducido)"; }
    }
  </style>
</head>
<body>
  <canvas id="fx"></canvas>

  <div class="overlay" aria-hidden="true">
    <div class="card">
      <h1>Feli Cunpleaños Diana</h1>
    
    </div>
  </div>

  

  <script>
    (() => {
      const canvas = document.getElementById('fx');
      const ctx = canvas.getContext('2d', { alpha: true });

      let w = 0, h = 0, dpr = 1;

const prefersReducedMotion = false; // siempre animación + auto

      function resize() {
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        w = Math.floor(window.innerWidth);
        h = Math.floor(window.innerHeight);
        canvas.width = Math.floor(w * dpr);
        canvas.height = Math.floor(h * dpr);
        canvas.style.width = w + 'px';
        canvas.style.height = h + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }
      window.addEventListener('resize', resize, { passive: true });
      resize();

      // Utilities
      const rand = (a, b) => a + Math.random() * (b - a);
      const clamp = (v, a, b) => Math.max(a, Math.min(b, v));

      function hsla(h, s, l, a) {
        return `hsla(${h}, ${s}%, ${l}%, ${a})`;
      }

      // Particles
      const particles = [];
      const rockets = [];

      // Config
      const gravity = 0.08;
      const air = 0.992;

      function addParticle(p) { particles.push(p); }
      function addRocket(r) { rockets.push(r); }

      function burst(x, y, strength = 1) {
        const baseHue = rand(0, 360);
        const count = Math.floor(rand(60, 110) * strength);
        const sparkle = Math.random() < 0.35;

        for (let i = 0; i < count; i++) {
          const a = rand(0, Math.PI * 2);
          const sp = rand(1.2, 4.8) * strength;
          const hue = (baseHue + rand(-30, 30) + i * 0.3) % 360;

          addParticle({
            x, y,
            vx: Math.cos(a) * sp,
            vy: Math.sin(a) * sp,
            life: rand(45, 95),
            maxLife: 0,
            size: rand(1.2, 2.6) * (sparkle ? 1.1 : 1),
            hue,
            sat: rand(70, 100),
            lum: rand(55, 70),
            alpha: rand(0.75, 1),
            twinkle: sparkle && Math.random() < 0.55,
            trail: Math.random() < 0.25
          });
        }

        // ring
        if (Math.random() < 0.18 && !prefersReducedMotion) {
          const ringCount = Math.floor(90 * strength);
          for (let i = 0; i < ringCount; i++) {
            const a = (i / ringCount) * Math.PI * 2;
            addParticle({
              x, y,
              vx: Math.cos(a) * rand(3.0, 5.0) * strength,
              vy: Math.sin(a) * rand(3.0, 5.0) * strength,
              life: rand(35, 70),
              maxLife: 0,
              size: rand(1.0, 2.0),
              hue: (baseHue + 120) % 360,
              sat: 90,
              lum: 60,
              alpha: 0.9,
              twinkle: false,
              trail: true
            });
          }
        }
      }

      function launchRocket(fromX, fromY, toX, toY) {
        const dx = toX - fromX;
        const dy = toY - fromY;

        // Aim mostly upwards
        const vx = clamp(dx / 55, -3, 3);
        const vy = clamp(dy / 55, -8, -4);

        addRocket({
          x: fromX,
          y: fromY,
          vx,
          vy,
          life: 0,
          fuse: rand(35, 70),
          hue: rand(0, 360),
          trail: []
        });
      }

      function clearScreen() {
        ctx.clearRect(0, 0, w, h);
        particles.length = 0;
        rockets.length = 0;
      }

      // Draw helpers
      function fade() {
        // motion blur / persistence
        ctx.globalCompositeOperation = 'source-over';
        ctx.fillStyle = 'rgba(0,0,0,0.18)';
        ctx.fillRect(0, 0, w, h);
      }

      function drawParticle(p) {
        // Trail line
        if (p.trail && !prefersReducedMotion) {
          ctx.beginPath();
          ctx.strokeStyle = hsla(p.hue, p.sat, p.lum, p.alpha * 0.45);
          ctx.lineWidth = 1;
          ctx.moveTo(p.x, p.y);
          ctx.lineTo(p.x - p.vx * 1.8, p.y - p.vy * 1.8);
          ctx.stroke();
        }

        const tw = p.twinkle ? (Math.sin(performance.now() / 60 + p.x) * 0.35 + 0.65) : 1;
        ctx.beginPath();
        ctx.fillStyle = hsla(p.hue, p.sat, p.lum, p.alpha * tw);
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fill();
      }

      function drawRocket(r) {
        // Trail
        r.trail.push({ x: r.x, y: r.y });
        if (r.trail.length > 12) r.trail.shift();

        if (!prefersReducedMotion) {
          ctx.beginPath();
          ctx.strokeStyle = hsla(r.hue, 90, 70, 0.55);
          ctx.lineWidth = 2;
          for (let i = 0; i < r.trail.length; i++) {
            const t = r.trail[i];
            if (i === 0) ctx.moveTo(t.x, t.y);
            else ctx.lineTo(t.x, t.y);
          }
          ctx.stroke();
        }

        // Rocket head
        ctx.beginPath();
        ctx.fillStyle = hsla(r.hue, 95, 65, 1);
        ctx.arc(r.x, r.y, 2.2, 0, Math.PI * 2);
        ctx.fill();
      }

      // Animation loop
      let last = performance.now();
      function tick(now) {
        const dt = Math.min(32, now - last);
        last = now;

        fade();

        // Rockets update
        for (let i = rockets.length - 1; i >= 0; i--) {
          const r = rockets[i];
          r.life += 1;

          r.x += r.vx * (dt / 16);
          r.y += r.vy * (dt / 16);

          // slight drag
          r.vx *= air;
          r.vy *= air;

          // pull up-to-down
          r.vy += gravity * 0.35 * (dt / 16);

          drawRocket(r);

          const out = r.y < -40 || r.x < -40 || r.x > w + 40;
          if (r.life >= r.fuse || out) {
            // explode
            burst(r.x, r.y, rand(0.9, 1.35));
            rockets.splice(i, 1);
          }
        }

        // Particles update
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];

          // physics
          p.x += p.vx * (dt / 16);
          p.y += p.vy * (dt / 16);
          p.vx *= air;
          p.vy *= air;
          p.vy += gravity * (dt / 16);

          // life
          p.life -= 1;
          const lifeRatio = p.life / (p.maxLife || (p.maxLife = p.life + 1));
          p.alpha = clamp(lifeRatio, 0, 1);

          drawParticle(p);

          if (p.life <= 0 || p.y > h + 40) {
            particles.splice(i, 1);
          }
        }

        requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);

      // Interaction
      function pointerPos(e) {
        if (e.touches && e.touches.length) return { x: e.touches[0].clientX, y: e.touches[0].clientY };
        return { x: e.clientX, y: e.clientY };
      }

      function onTap(e) {
        const { x, y } = pointerPos(e);
        // Randomly decide rocket vs burst
        if (Math.random() < 0.55 && !prefersReducedMotion) {
          launchRocket(rand(w * 0.2, w * 0.8), h + 10, x, y);
          launchRocket(rand(w * 0.2, w * 0.8), h + 10, x + rand(-80, 80), y + rand(-30, 30));
        } else {
          burst(x, y, rand(0.9, 1.2));
        }
      }

      window.addEventListener('pointerdown', onTap, { passive: true });

      // Controls
      const btnBurst = document.getElementById('burst');
      const btnRocket = document.getElementById('rocket');
      const btnClear = document.getElementById('clear');
      const autoToggle = document.getElementById('auto');
      const autoDot = document.getElementById('autoDot');

      btnBurst.addEventListener('click', (e) => {
        e.stopPropagation();
        burst(rand(w * 0.2, w * 0.8), rand(h * 0.15, h * 0.55), rand(1.0, 1.4));
      });

      btnRocket.addEventListener('click', (e) => {
        e.stopPropagation();
        launchRocket(rand(w * 0.2, w * 0.8), h + 10, rand(w * 0.2, w * 0.8), rand(h * 0.12, h * 0.5));
      });

      btnClear.addEventListener('click', (e) => {
        e.stopPropagation();
        clearScreen();
      });

      let auto = true;
      function setAuto(v) {
        auto = v;
        autoDot.classList.toggle('off', !auto);
        autoToggle.setAttribute('aria-pressed', String(auto));
      }
      setAuto(auto);

      autoToggle.addEventListener('click', (e) => {
        e.stopPropagation();
        setAuto(!auto);
      });
      autoToggle.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          setAuto(!auto);
        }
      });

      // Auto fireworks
      function autoLoop() {
        if (auto) {
          const x = rand(w * 0.15, w * 0.85);
          const y = rand(h * 0.12, h * 0.55);
          if (Math.random() < 0.62 && !prefersReducedMotion) {
            launchRocket(rand(w * 0.2, w * 0.8), h + 10, x, y);
          } else {
            burst(x, y, rand(0.9, 1.3));
          }
        }
        setTimeout(autoLoop, prefersReducedMotion ? 1400 : rand(520, 920));
      }
      autoLoop();

      // Initial celebratory bursts
      if (!prefersReducedMotion) {
        setTimeout(() => burst(w * 0.25, h * 0.25, 1.2), 350);
        setTimeout(() => burst(w * 0.70, h * 0.30, 1.1), 650);
        setTimeout(() => launchRocket(w * 0.55, h + 10, w * 0.55, h * 0.25), 900);
      } else {
        // Minimal motion: a couple of static bursts
        setTimeout(() => burst(w * 0.5, h * 0.28, 0.9), 350);
      }
    })();
  </script>
</body>
</html>
